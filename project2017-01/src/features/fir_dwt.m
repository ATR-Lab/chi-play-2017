clear allclose allclcpkg load signalf_slash       = "/";sub           = "sub02-170322";training_set  = "set1";task          = "on";filter        = "time-domain";motion        = "down";path          = [pwd, "/data/intermediate/", sub, f_slash, training_set, f_slash, task, f_slash, filter, f_slash, motion];filename      = "Sub02-Lee_GY_o_TimeDomain_down_ch1_170322.csv";ch1_filename  = [path, f_slash, filename];csv_output    = csvread(ch1_filename);data_points   = 4097;Fs            = 2048; % Sampling frequency/rate 2048HzTs            = 1/Fs; % Sampling perioddt            = 0:Ts:4000-Ts% Signal duration%dt            = 0:Ts:5e-3-Ts% Signal duration from video tutorial## Time Domain data as is#figure(1);trial_data1 = csv_output(:, [2]);trial_data1 = trial_data1(:);plot(trial_data1);title("Time Domain Without Filter");xlim([1, 4000]);#{figure(7);trial_data1 = csv_output(:, [2]);trial_data1 = trial_data1(:);%plot(trial_data1);plot(abs(trial_data1/max(trial_data1)));title("Time Domain Without Filter");xlim([1, 4000]);#}## DWT of Time Domain data without filter#figure(2);%[c1,info]=fwt(trial_data1,'sym8',11);[c1,info]=fwt(trial_data1,'sym8',14);plot(c1);title("DWT of Time Domain Without Filter");xlim([1, 2000]);## FFT of Time Domain data#figure(3);nfft  = length(trial_data1);nfft2 = 2.^nextpow2(nfft);fy    = fft(trial_data1, nfft2);%fy    = fy(1:nfft2);fy    = fy(1:nfft2/2);%xfft  = Fs .* (0:nfft2-1)/nfft2;xfft  = Fs .* (0:nfft2/2-1)/nfft2;plot(xfft, abs(fy/max(fy)));title("FFT of Time Domain");## Time Domain data with FIR filter#figure(4);cut_off = 10; %400 Hzcut_off = cut_off/Fs/2; %normalize it to Nyquist frequency% order   = 16;order   = 64;h       = fir1(order, cut_off);con     = conv(trial_data1, h);plot(con);title("Time Domain with FIR Filter");xlim([1, 4000]); ## DWT of Time Domain data with FIR filter#figure(5); %[c1,info]=fwt(conv,'sym8',14); %[c1,info]=fwt(con,'db4',16); %[c1,info]=fwt(con,'db44',4); [c1,info]=fwt(con,'db4',16); plot(c1);title("DWT of Time Domain with FIR Filter");xlim([1,2000]);figure(6)stem(h);## Extract Details## http://stackoverflow.com/questions/27290088/how-do-you-get-the-approximations-and-details-of-a-wavelet-transform-in-ltfa##{% the DWT coefficients are split according to the different levelscellCoeffs = wavpack2cell(c1, info.Lc);% number of "bands", including the approximations and all the detailsnBands = length(info.Lc);% a cell array containing the coefficients of the DWT (in the form required by "wavcell2pack") for the reconstructionemptyCellCoeffs = cell(nBands,1);% the cell corresponding to each "band" is set to a vector of zeros of the appropriate lengthfor i=1:nBands    emptyCellCoeffs{i} = zeros(info.Lc(i),1);end% it will contain the aproximations and detailsres = zeros(nBands,length(signal));for i=1:nBands    % a copy of the coefficients for the reconstruction with everything set to zero...    aux = emptyCellCoeffs;    % ...except the coefficients for the corresponding level    aux{i} = cellCoeffs{i};    % inverse DWT after turning the cell representation back into a vector    res(i,:) = ifwt(wavcell2pack(aux),info);enderror = sum(sum(res,1) - signal')#}%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%trial_data2 = csv_output(:, [2]);trial_data2 = trial_data2(:);subplot(4, 2, 3)plot(trial_data2);xlim([1, 4000]);[c2,info]=fwt(trial_data2,'sym8',11);subplot(4, 2, 4);plot(c2);xlim([1, 2000]);  info%%%%trial_data3 = csv_output(:, [3]);trial_data3 = trial_data3(:);subplot(4, 2, 5)plot(trial_data3);xlim([1, 4000]);[c3,info]=fwt(trial_data3,'sym8',11);subplot(4, 2, 6);plot(c3);xlim([1, 2000]);%%%%trial_data4 = csv_output(:, [4]);trial_data4 = trial_data4(:);subplot(4, 2, 7)plot(trial_data4);xlim([1, 4000]);[c4,info]=fwt(trial_data4,'sym8',11);subplot(4, 2, 8);plot(c4);xlim([1, 2000]);  